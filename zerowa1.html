<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>BattleKnight Spamownik - v2</title>
  <style>
    :root {
      --primary-red: #f00;
      --hover-red: #d00;
      --bg-black: #0a0a0a;
      --input-bg: #1a1a1a;
      --border-color: #333;
    }
    body {
      background: #000;
      color: var(--primary-red);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      text-align: center;
      max-width: 1000px;
      margin: auto;
      padding: 40px 20px;
    }
    h1 { font-size: 1.1rem; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 25px; line-height: 1.5; }
    #linkInput { width: 100%; padding: 15px; background: var(--input-bg); border: 1px solid var(--border-color); color: #fff; border-radius: 8px; font-size: 16px; margin-bottom: 20px; box-sizing: border-box; }
    .settings-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; background: var(--bg-black); padding: 20px; border-radius: 12px; border: 1px solid #222; align-items: end; }
    .form-group { display: flex; flex-direction: column; text-align: left; }
    .full-width { grid-column: span 3; }
    label { font-size: 11px; font-weight: bold; margin-bottom: 6px; color: #888; text-transform: uppercase; }
    input, select { background: var(--input-bg); border: 1px solid var(--border-color); color: #fff; padding: 12px; border-radius: 6px; font-size: 14px; width: 100%; box-sizing: border-box; }
    .btn-start { grid-column: span 3; background-color: var(--primary-red); color: #fff; font-weight: bold; cursor: pointer; border: none; padding: 16px; border-radius: 6px; font-size: 18px; transition: all 0.2s ease; text-transform: uppercase; margin-top: 10px; }
    .btn-start:hover { background-color: var(--hover-red); box-shadow: 0 0 15px rgba(255, 0, 0, 0.4); }
    #status { margin-top: 30px; font-size: 22px; font-weight: bold; border-top: 1px solid #222; padding-top: 20px; }
    
    @media (max-width: 768px) {
      .settings-grid { grid-template-columns: 1fr 1fr; }
      .full-width, .btn-start { grid-column: span 2; }
    }
  </style>
</head>
<body>
  <h1>Wklej link do ataku lub wybierz gracza z listy,<br>ustal godzinƒô i interwa≈Ç</h1>

  <input type="text" id="linkInput" placeholder="Wklej tutaj link do ataku" />

  <div class="settings-grid">
    <div class="form-group full-width">
      <label>üéØ Wybierz cel z listy</label>
      <select id="linkSelector" onchange="selectLink(this)">
        <option value="">‚¨áÔ∏è Lista zapisanych graczy</option>
        <option value="https://s55-pl.battleknight.gameforge.com/duel/duel/?enemyID=3315451">Kabuto</option>
        </select>
    </div>

    <div class="form-group">
      <label>üïì Zaplanuj start</label>
      <input type="datetime-local" id="startTime" step="1"/>
    </div>

    <div class="form-group">
      <label>üîÅ Liczba pr√≥b</label>
      <input type="number" id="attemptsLimit" value="120"/>
    </div>

    <div class="form-group">
      <label>‚è±Ô∏è Min/Max ms</label>
      <div style="display: flex; gap: 5px;">
        <input type="number" id="minMs" value="450" style="width: 50%;"/>
        <input type="number" id="maxMs" value="550" style="width: 50%;"/>
      </div>
    </div>

    <button class="btn-start" onclick="planOrStart()">ROZPOCZNIJ ATTAK</button>
  </div>

  <div id="status">Wys≈Çane ataki: 0</div>

  <script>
    let openedCount = 0;
    let attackWindow = null;
    let nextAttackTimer;

    function selectLink(selectElement) {
      const selectedLink = selectElement.value;
      if (selectedLink) document.getElementById("linkInput").value = selectedLink;
    }

    function planOrStart() {
      const timeInput = document.getElementById("startTime").value;
      const link = document.getElementById("linkInput").value;
      if (!link) { alert("Wklej link!"); return; }

      if (timeInput) {
        const ms = new Date(timeInput) - new Date();
        if (ms <= 0) { alert("Godzina ju≈º minƒô≈Ça!"); return; }
        document.getElementById("status").innerText = `Oczekiwanie na start: ${new Date(timeInput).toLocaleTimeString()}...`;
        setTimeout(() => startSpam(link), ms);
      } else {
        startSpam(link);
      }
    }

    function startSpam(link) {
      openedCount = 0;
      clearTimeout(nextAttackTimer);

      const attemptsLimit = parseInt(document.getElementById("attemptsLimit").value) || 100;
      const minMs = parseInt(document.getElementById("minMs").value) || 450;
      const maxMs = parseInt(document.getElementById("maxMs").value) || 550;

      // Otwieramy ma≈Çe okno raz - przeglƒÖdarka zapyta o zgodƒô na wyskakujƒÖce okienka
      attackWindow = window.open("", "attackTab", "width=400,height=400");
      
      if (!attackWindow) {
        alert("Zablokowano wyskakujƒÖce okno! Zezw√≥l na nie w przeglƒÖdarce.");
        return;
      }

      const performAction = () => {
        if (openedCount >= attemptsLimit) {
          document.getElementById('status').innerText = `Zako≈Ñczono: ${openedCount} pr√≥b.`;
          if (attackWindow) attackWindow.close();
          return;
        }

        // Zmiana lokalizacji w otwartym oknie (symuluje klikniƒôcie w zak≈Çadkƒô)
        attackWindow.location.href = link;
        
        openedCount++;
        document.getElementById('status').innerText = `Wys≈Çane ataki: ${openedCount}`;

        let randDelay = Math.floor(Math.random() * (maxMs - minMs + 1)) + minMs;
        nextAttackTimer = setTimeout(performAction, randDelay);
      };

      performAction();
    }
  </script>
</body>
</html>
